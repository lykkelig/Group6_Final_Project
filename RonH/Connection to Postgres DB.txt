# Connect to your Postgres DB and read in our data
# Assume you have psycopg2 installed
#      Psycopg is the most popular PostgreSQL database adapter for the Python programming language.
# If not, install using PIP or Conda
# PIP:
#       pip install psycopg2
#
# From Anaconda prompt using Conda:
#        conda install -c anaconda psycopg2   

import pandas as pd
import psycopg2

# Replace yourPW with the actual password you used when you installed Postgres 
connect("host='{}' port={} dbname='{}' user={} password={}".format('127.0.0.1', 5432, 'Group6Final', 'postgres', 'yourPW'))

# Make sure this is entered as ONE line in Jupyter, NOT multiple line
sql2 = 'SELECT "Age", "Attrition",  "BUSINESSTRAVEL", "DailyRate", "DEPARTMENT", "DistanceFromHome", "Education", "EDUCATIONFIELD",  "EmployeeCount", "EmployeeNumber", "EnvironmentSatisfaction", "GENDER", "HourlyRate", "JobInvolvement", "JobLevel", "JOBROLE",  "JobSatisfaction", "MARITALSTATUS", "MonthlyIncome", "MonthlyRate", "NumCompaniesWorked", "Over18", "OverTime", "PercentSalaryHike", "PerformanceRating", "RelationshipSatisfaction", "StandardHours", "StockOptionLevel", "TotalWorkingYears", "TrainingTimesLastYear", "WorkLifeBalance", "YearsAtCompany", "YearsInCurrentRole", "YearsSinceLastPromotion", "YearsWithCurrManager", "NumberProjects", "WorkplaceAccident" FROM "Employee_Status" AS ES JOIN "CD_TRAVEL" CDT ON ES."BusinessTravel_FK" = CDT."BUSINESSTRAVEL_FK"  JOIN "CD_DEPARTMENT" CDD ON ES."Department_FK" = CDD."DEPARTMENT_FK" JOIN "CD_EDUCATIONFIELD" CDE ON ES."EducationField_FK" = CDE."EDUCATIONFIELD_FK" JOIN "CD_GENDER" CDG ON ES."Gender_FK" = CDG."GENDER_FK" JOIN "CD_ROLE" CDR ON ES."JobRole_FK" = CDR."JOBROLE_FK" JOIN "CD_M_STATUS" CDS ON ES."MaritalStatus_FK" = CDS."MARITALSTATUS_FK"'

# This should read the table into a dataframe, that's all we needed from Postgres (except for the busy work (ERD))
dat = pd.read_sql_query(sql, conn)
dat.head()

# Close the connection, no longer needed, everything is done in Pandas now
conn = None

